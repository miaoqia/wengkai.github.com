<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=gb_2312-80">
   <meta name="KeyWords" content="amateur radio aprs gprs">
   <title>APRS Box</title>
</head>
<body>
<center><font face="宋体"><font size=+2>APRS Box G8201使用说明</font></font></center>
<hr>
<font size=-1>
<a href="#1">安装</a> | 
<a href="#2">运行</a> | 
<a href="#3">故障诊断</a> | 
<a href="#4">短信配置</a></font>
<a name="1"></a>
<h2>安装</h2>
<p>
有三个指示灯和SIM卡抽屉的一面，应安装GSM天线；有电源线接入的一面，应安装GPS天线。
</p>
<p>请选择中国移动的SIM卡，并开通cmnet方式的GPRS。经过我们的测试，中国联通的GPRS网络和移动的cmwap不能使用。
如果每天只是在市区开车通勤，建议采用2元包月的GPRS套餐，如果每天走高速通勤，可以考虑采用5元包月。
可以第一月先包较高额度的套餐，运行一个月以后再根据自己的使用量调整。</br>
请先关闭设备电源再插拔SIM卡，带电插拔SIM卡可能造成卡和设备的损坏。
</p>
<p>
GPS天线应安装在能垂直“见”到天空的位置，有磁铁的一面朝下。如果不能安装在车顶，至少应该紧贴放在大面积的车窗下，并且那面车窗不能使用有金属成分的贴膜。
安装GPS天线的插头时，请不要带着馈线旋转插头上的套管。正确的手势是，用一只手的两个指头捏住馈线的末端，另一只手的掌面压住整机，用两个指头捏住套筒旋转。
如果这样的姿势很困难，也可以用一只手捏住套筒保持不动，另一只手抓住并旋转G8201整机来插上插头。
带着馈线旋转插头极易造成插头内部短路，进而损坏机内电路。
</p>
<p>
电源线为红黑两色，红线应接电源正极。APRS Box设计为在12V电池的车上工作，不能用于24V电池的车辆。APRS Box内部元件能承受的短时最高输入电压为25V。一般工作时，APRS Box消耗的电流为60mA左右。当遇到GSM信号不良的场所，工作电流可能升高到1A。
</p>
<p>
APRS Box内部有反接装置，如果接入的电源极性错误，会形成短路电流，将外部电源回路中的保险丝熔断，从而避免内部电路受损。但是如果接入线路中没有保险装置，如将APRS Box直接接在汽车电瓶上，那么反接时造成的短路电流会烧毁APRS Box内部的保护电路。我们建议将APRS Box安装于汽车点烟器电路上。
</p>
<p>
<a name="2"></a>
<h2>运行</h2>
<p>
APRS Box面板的三个LED用来指示设备运行的状态。三个灯的定义如下：
<ul>
  <li>绿色：GPS灯，表示GPS收到有效的位置数据。
  <li>红色：工作灯，表示APRS Box在发送数据。
  <li>黄色：GSM灯，闪烁表示GSM模块在做通信。
</ul>
</p>
<p>
在上电开机时，三个灯组合起来表示设备初始化的进程，初始化会经历以下的阶段：
<ol>
  <li>红亮，绿亮，黄灭：设备在读SIM卡的数据，等待GSM模块初始化完成；
  <li>红亮，绿亮，黄闪：GSM模块在注册到运营商的基站；
  <li>红亮，绿灭，黄闪：APRS Box在连接和注册到APRS服务器；
  <li>红亮，绿闪一下，黄闪：已经得到GPS有效的位置数据，向APRS服务器发送第一个数据。
</ol>
</p>
<p>
在上电完成后，每1秒左右，绿灯会闪烁一下。如果符合发送数据的条件，则红灯会亮起，直到数据发送完毕。当收到有效的短信，在做配置或报告时，红灯也会亮起。黄灯则不定时地会闪烁几下，与设备的工作状态没有直接的联系。
</p>
<p>
APRS Box根据以下规则决定向服务器报告数据：
<ol>
  <li>上次报告的数据已经由服务器收到并且
  <li>与上次报告时间经过了5秒，并且
  <li>当前经纬度坐标的经度或纬度的分与上次报告时的变化超过1%，并且
  <li>距上次报告数据经过了设定的间隔时间，默认为60秒；
  <li>或与上次报告时的前进角度差大于30度；
  <li>或与上次报告时的位置距离较远。
</ol>
</p>
<p>
从1.3.d版开始，APRS Box报告的数据中包含一些运行状态信息。
从aprs.fi的信息框中可以看到如下一行：
<blockquote><code>
	APRS Box 110113 C22L
</code></blockquote>
其中110113是固件版本时间，表示为2011年1月13日的固件版本。
而后面的4位：C22L，其中的22表示GSM信号质量，如果以x表示这个值，那么当时的信号强度是:</br>
<div align="center">
-112dBm + 2 &times; x
</div>
而最后一个字母L表示该数据发送的原因。一共有四种原因：
<ul>
	<li>R：重新连接服务器后的第一个数据
	<li>T：由于设定的时间到而发送的数据
	<li>L：由于经过了一定的路程而发送的数据
	<li>A：由于发生了足够角度的转向而发送的数据
</ul>
</p>
<a name="3"></a>
<h2>故障诊断</h2>
<p>
通过面板三个LED，可以大致判断设备故障的大多数情况。
<ul>
  <li>开机时，保持在第一个阶段，一般是GSM模块或SIM卡损坏，如果更换别的SIM卡不能解决问题，说明是GSM模块损坏；
  <li>开机时，保持在第二个阶段，一般是SIM卡失效（如停机），或内部硬件损坏，如果更换别的SIM卡不能解决问题，说明是内部硬件损坏。当所处的位置信号不好时，也可能是GSM天线连接问题；
  <li>开机时，保持在第三个阶段，一般是GSM天线连接问题；
  <li>运行时绿灯不闪烁，一般是GPS天线问题，需检查天线连接及安装位置。
</ul>
</p>
<p>
GPS天线的SMA插头较容易在安装过程中受损，如果插头内部形成了短路，还会进一步损坏机内的GPS模块。可以用万用表电阻档检查天线，插头的两端之间的电阻应为7M欧姆左右，完全断路，或电阻小于1M欧姆都表明天线已经损坏。
</p>
<p>
也可以通过拨打设备内SIM卡的号码来大致判断故障：
<ul>
	<li>设备正常时，拨打其号码会被挂断，听到类似“你呼叫的号码正在通话中”的提示
	<li>如果听到“您呼叫的号码暂时无法接通”，说明GSM信号太差，需要检查GSM天线及安装的位置是否屏蔽了GSM信号
	<li>如果听到“您呼叫的号码已关机”，说明设备断电，需要检查设备供电
	<li>如果听到回铃音，而一直没有被挂断，说明设备内部有故障，需要返修
</ul>
</p>
<a name="4"></a>
<h2>短信配置</h2>
<p>
用户可以自己发短信给APRS Box来获知运行状况或做参数配置。APRS Box里记录了一个机主号码，只有这个号码可以向APRS Box发短信。其他号码所发的短信会被忽略，不会对APRS Box造成任何后果。如果您的APRS Box不理睬您的手机所发的短信指令，请与BA5AG联系修改。
短信指令中所有的字母和数字都必须是半角的。以下指令和回复中的“变量”的含义如下：
<dl>
  <dt>&lt;call&gt;：
  <dd>呼号，包括呼号后面的’-‘和站台编号，如“BG5AAA-9”。
  <dt>&lt;t&gt;：
  <dd>站台类型数值，决定显示在APRS地图上的图标。如9代表小汽车。可以使用的类型有：
    <ol>
      <li>救护车
      <li>巴士
      <li>救火车
      <li>自行车
      <li>游艇
      <li>直升机
      <li>飞机
      <li>船
      <li>轿车
      <li>摩托车
      <li>气球
      <li>吉普
      <li>特种车
      <li>卡车
      <li>面包车
    </ol>
  <dt>&lt;h&gt;：
  <dd>硬件版本号，一个4位的数字，如1005，表示2010年5月的硬件版本。
  <dt>&lt;s&gt;：
  <dd>固件版本号，一个6位的数字，如101222，表示2010年12月22日的固件版本。
  <dt>&lt;n&gt;：
  <dd>序列号，数字。
  <dt>&lt;server&gt;：
  <dd>服务器地址，包含域名和端口号，如china.aprs2.net:14580。
  <dt>&lt;phone&gt;：
  <dd>电话号码，不含国家冠字，如13456789012。
  <dt>&lt;d&gt;：
  <dd>数字，如1。
  <dt>&lt;i&gt;：
  <dd>数字，表示间隔。
</dl>
</p>
<p>
以下列出用户可以使用的命令，以及APRS Box会通过短信回复的回答。如果命令或命令中的格式或数据有误，APRS Box会回答ERROR。
<dl>
  <dt>重起：REBOOT
         <dd>OK &lt;call&gt; type &lt;t&gt; HW &lt;h&gt; SW &lt;s&gt; REBOOTED
  <dt>检查状态：CK
         <dd>&lt;call&gt; type &lt;t&gt; HW &lt;h&gt; SW &lt;s&gt; SN &lt;n&gt;&lt;connected|disconnected&gt; at &lt;server&gt;
  <dt>检查配置：RC
         <dd>&lt;call&gt; type &lt;t&gt; interval &lt;i&gt;</br>
         Server 1-&lt;server&gt; 2-&lt;server&gt;</br>
         TEXT &lt;text&gt;
         SMS&lt;phone&gt;</br>
         该指令回答四行，可能会超过一条短信的长度。
  <dt>配置服务器：SC URL &lt;d&gt; &lt;server&gt;
         <dd>&lt;dd&gt;OK Server 1-&lt;server&gt; 2-&lt;server&gt;</br>
         APRSBox可以配置三个服务器地址，每次短信指令只能修改其中的一个。
  <dt>配置附加文字：SC TEXT &lt;text&gt;
  		 <dd>OK TEXT &lt;text&gt;
  		 配置显示在地图上的信息框中的文字。最长可以25个字符，只能使用英文字母、数字、符号和空格。
  		 如果SC TEXT后面不跟任何文字，则不显示文字。
  <dt>配置数据间隔：SC INT &lt;i&gt;
         <dd>OK interval &lt;i&gt;</br>
         默认数据间隔为60秒。
  <dt>配置站台类型：SC TYPE &lt;t&gt;
         <dd>OK &lt;call&gt; type &lt;t&gt;</br>
         默认站台类型为9。
  <dt>配置机主号码：SC SMS &lt;phone&gt;
         <dd>OK SMS &lt;phone&gt;
</dl>
</p>
<p>
向APRS Box发送短信指令会导致APRS Box回复短信，这可能会产生相应的费用。
</p>
</body>
</html>
